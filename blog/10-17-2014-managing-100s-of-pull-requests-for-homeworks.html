<!DOCTYPE html>
<html>
    <head>
    <title>Managing 100s of pull requests for homeworks &middot; Reproducible Research.</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="http://eriqande.github.io/rep-res-web/www/bootstrap.min.css" rel="stylesheet">
    <link href="http://eriqande.github.io/rep-res-web/www/highlight.css" rel="stylesheet">

    <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700'
      rel='stylesheet' type='text/css'>
  </head>

  <body>
    <div class="navbar navbar-default navbar-static-top">
 <div class="navbar-header"><a class="navbar-brand" href="http://eriqande.github.io/rep-res-web">RepResCourse</a>
      <a class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="http://eriqande.github.io/rep-res-web/syllabus.html">Syllabus</a></li>
        <li><a href="http://eriqande.github.io/rep-res-web/resources.html">Resources</a></li>
        <li><a href="http://eriqande.github.io/rep-res-web/blogs.html">Instructor Blog</a></li>
        <li><a href="#">Results/Gallery</a></li>
      </ul>
      <div class="navbar-right">
    	<p class="navbar-text">I'm navbar-fixed-top</p>
  	  </div>
    </div>
</div>


    <div class="container">
            <!-- The title and stuff is here -->
      <div class="masthead">
        <p> </p>
        <p> </p>
        <h3 class="muted"><a href="http://eriqande.github.io/rep-res-web/">Reproducible Research Course</a> <small>by Eric C. Anderson for (NOAA/SWFSC)</small></h3>
        <hr>
      </div>

      <div class="row">
        <div class="col-sm-3" id="nav">
          <div class="well">
  How's this site built? See all sources at the course <a href="http://github.com/eriqande/rep-res-course">repository</a> on GitHub.
  <p><hr></p>
  <p><a class="btn btn-primary" href="https://raw.githubusercontent.com/eriqande/rep-res-course/master/_posts/2014-10-17-managing-100s-of-pull-requests-for-homeworks.rmd">Raw on GitHub</a></p>
</div>

<h4>Page Contents</h4>
<ul class="list-unstyled" id="toc"></ul>

<hr>
<p><a href="http://eriqande.github.io/rep-res-web/contribute.html">How to contribute</a></p>
<p><a class="btn btn-primary" href="https://github.com/eriqande/rep-res-course/edit/master/_posts/2014-10-17-managing-100s-of-pull-requests-for-homeworks.rmd">Edit this page</a></p>


        </div>

        <div id="content" class="col-sm-8 pull-right">
          <h1>Managing 100s of pull requests for homeworks (2014-10-17)</h1>
<p>OK, I have been working on a little R-package called <a href="https://github.com/eriqande/rrhw">rrhw</a> that will facilitate writing homework sets within .Rmd files that the students will insert their answers into, inside a <code>submit_answer</code> function that will capture their expression and evaluate it. With this framework I will be able to record everyone’s answers into a data frame and use the same <code>submit_answer()</code> functions to print out the results in a nice web page so that students can quickly see the range of answers that were given, as well as which ones give the right value and which the wrong, etc.</p>
<p>Students will be submitting these things as pull requests on branches that are named for each different homework assignment. So, with 50 pull requests coming in per assignment, I don’t want to handle that on github. It’s gotta be scriptable. I am hoping to be able to query github to quickly assess</p>
<ol style="list-style-type: decimal">
<li>which of the students have filed pull requests for the homework set.</li>
<li>what time they issued those pull requests (make sure they are on time, and also to allow them to update their answers and have a corrected version that might be from a different time…that might be a nightmare. It would probably be better to look at the time of the latest commit.)</li>
<li>Check to make sure that they haven’t committed more than the one file that I want them to submit.</li>
</ol>
<ul>
<li>And, if possible, send them an automatic message telling them to clean up their pull request.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Grab all the branches of a certain name and process them.</li>
</ol>
<p>So, one possibility is <a href="https://github.com/schacon/git-pulls">git-pulls</a>. It certainly will let me pull stuff down, but probably won’t let me automatically issue a comment on a student commit if it needs to be revised before I am willing to pull it.</p>
<h2 id="trying-git-pulls">Trying out git-pulls</h2>
<p>Let’s get it and start playing with it:</p>
<pre><code>sudo gem install git-pulls</code></pre>
<p>Then:</p>
<pre><code>2014-10-17 11:24 /rep-res-course/--% (master) git pulls update
Updating eriqande/rep-res-course
Checking for forks in need of fetching
  fetching aclemento/rep-res-course
remote: Counting objects: 72, done.
remote: Compressing objects: 100% (64/64), done.
remote: Total 72 (delta 15), reused 64 (delta 7)
Unpacking objects: 100% (72/72), done.
From https://github.com/aclemento/rep-res-course
 * [new branch]      ex-test    -&gt; refs/pr/aclemento/rep-res-course/ex-test
 * [new branch]      master     -&gt; refs/pr/aclemento/rep-res-course/master
  fetching eca-home/rep-res-course
remote: Counting objects: 6, done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 6 (delta 2), reused 5 (delta 2)
Unpacking objects: 100% (6/6), done.
From https://github.com/eca-home/rep-res-course
 * [new branch]      master     -&gt; refs/pr/eca-home/rep-res-course/master
 * [new branch]      mock-homework-1 -&gt; refs/pr/eca-home/rep-res-course/mock-homework-1
 * [new branch]      patch-3    -&gt; refs/pr/eca-home/rep-res-course/patch-3
Open Pull Requests for eriqande/rep-res-course
5    10/16 Testing the trial homework.         aclemento:ex-test                          </code></pre>
<p>OK, that seems to grab everything down and put it somewhere local. That is not so good if a student has committed a huge blob or something silly.</p>
<p>But, it does somehow get the stuff local, becuase when you run update again it doesn’t show anything new.</p>
<pre><code>2014-10-17 11:25 /rep-res-course/--% (master) git pulls update
Updating eriqande/rep-res-course
Checking for forks in need of fetching
Open Pull Requests for eriqande/rep-res-course
5    10/16 Testing the trial homework.         aclemento:ex-test                                 </code></pre>
<p>Apparently, it puts all the information into <code>.git/pulls_cache.yml</code>, which doesn’t get committed into your repository. But is there nonetheless. that is cool.</p>
<pre><code>2014-10-17 11:31 /.git/--% (GIT_DIR!) du -h pulls_cache.yml
400K  pulls_cache.yml</code></pre>
<h3>Info about the commit in the pull request</h3>
<p>I can do this:</p>
<pre><code>2014-10-17 12:13 /rep-res-course/--% (master) git-pulls show 5
Number   : 5
Label    : aclemento:ex-test
Creator  : aclemento
Created  : 2014-10-16 19:54:31 UTC

Title    : Testing the trial homework.



------------

cmd: git diff HEAD...e4370bd874543a888adfa99160921d9852c9d1de
 exercises/trial_homework.rmd | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)</code></pre>
<p>So, I could probably do this:</p>
<pre><code>git-pulls show 5 | tail -n 2 | awk &#39;{printf(&quot;%s\t&quot;, $1);} END {printf(&quot;\n&quot;)}&#39; </code></pre>
<p>Note that if the diff has nothing in it then that will screw things up</p>
<pre><code>2014-10-17 12:41 /rep-res-course/--% (master) git-pulls show 2
Number   : 2
Label    : eca-home:patch-3
Creator  : eca-home
Created  : 2014-10-01 16:49:14 UTC

Title    : Silly change

Just making a pull request.

------------

cmd: git diff HEAD...a522320f97f9c5b7e2ed37147389537d5c93a1f3
</code></pre>
<p>So, I will have to make it tolerant of that. Although I think that might only occur if I have merged the pull request in and then not changed that part of the file since then.</p>
<h3>Checkout out the pull requests</h3>
<p>I tried this:</p>
<pre><code>2014-10-17 12:48 /rep-res-course/--% (master) git-pulls checkout
Checking out all open pull requests for eriqande/rep-res-course
&gt; ex-test into pull-ex-test
error: the requested upstream branch &#39;origin/ex-test&#39; does not exist
hint: 
hint: If you are planning on basing your work on an upstream
hint: branch that already exists at the remote, you may need to
hint: run &quot;git fetch&quot; to retrieve it.
hint: 
hint: If you are planning to push out a new local branch that
hint: will track its remote counterpart, you may want to use
hint: &quot;git push -u&quot; to set the upstream config as you push.</code></pre>
<p>That is not so great.</p>
<h2>Notifying students</h2>
<p>Check this out. I can email stuff to my noaa gmail account like this:</p>
<pre><code>echo &quot;gotta check this out &quot; | mail -s &quot;testing mail&quot; eric.anderson@noaa.gov</code></pre>
<p>So, I ought to be able to email things to students, like requests to delete extraneous files from homework branches. It would be better if I could submit a comment to the pull request from the command line directly to github, but I am not sure how that would work. If I could figure out how GitHub created the reply-to email for its notifications I would be able to do that, but I can’t figure that out. Oh well. It will probably be OK to just sent email directly to the student.</p>

          <hr>
           <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rep-res-course'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
        </div>
      </div>

            <div class="footer">
        <hr>
        <p>
          <small>
            Authored by Eric C. Anderson working as a Federal employee.  Content on this website is a government work in the public domain in the U.S. and under the CC0 1.0 internationally. Templates and plugins to build the site are modified from Hadley Wickham's <a href="https://github.com/hadley/adv-r/">Advanced R</a> website. Powered by <a href="http://jekyllrb.com/">jekyll</a>,
          <a href="http://yihui.name/knitr/">knitr</a>, and
          <a href="http://johnmacfarlane.net/pandoc/">pandoc</a>. Source
          available on <a href="https://github.com/eriqande/rep-res-course/">github</a>.
          </small>
        </p>
      </div>


    </div> <!-- /container -->

  <script src="//code.jquery.com/jquery.js"></script>
  <script src="http://eriqande.github.io/rep-res-web/www/bootstrap.min.js"></script>
  <script src="http://eriqande.github.io/rep-res-web/www/toc.js"></script>
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  </body>
</html>

